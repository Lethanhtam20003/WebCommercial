<form [formGroup]="purchaseForm" (ngSubmit)="submit()" class="container mt-3">
  <div class="mb-3">
    <label class="form-label">Nhà cung cấp</label>
    <select class="form-select" formControlName="supplierId">
      <option *ngFor="let s of suppliers" [value]="s.id">{{ s.name }}</option>
    </select>
  </div>

  <div class="mb-3">
    <label class="form-label">Ngày tạo</label>
    <input type="datetime-local" class="form-control" formControlName="createdAt" />
  </div>

  <div formArrayName="items"  class="items-scroll-box">
    <div
      *ngFor="let item of items.controls; let i = index"
      [formGroupName]="i"
      class="border p-3 rounded mb-3 bg-light" 
    >
      <div class="row g-3 align-items-end">
        <div class="col-md-5">
          <label class="form-label">Sản phẩm</label>
          <select class="form-select" formControlName="productId">
            <option *ngFor="let p of products" [value]="p.id">{{ p.name }}</option>
          </select>
        </div>

        <div class="col-md-2">
          <label class="form-label">Số lượng</label>
          <input type="number" class="form-control" formControlName="quantity" />
        </div>

        <div class="col-md-2">
          <label class="form-label">Đơn giá</label>
          <input type="number" class="form-control" formControlName="unitPrice" />
        </div>

        <div class="col-md-2">
          <label class="form-label">Tổng</label>
          <p class="form-control-plaintext">{{ item.value.quantity * item.value.unitPrice | number }}</p>
        </div>

        <div class="col-md-1 text-end">
          <button type="button" class="btn btn-danger btn-sm" (click)="removeItem(i)" *ngIf="items.length > 1">
            &times;
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="d-flex justify-content-between mb-3">
    <button type="button" class="btn btn-outline-primary" (click)="addItem()">+ Thêm dòng</button>
    <h5>Tổng tiền: {{ totalPrice | number }} VND</h5>
  </div>

  <button type="submit" class="btn btn-success" [disabled]="purchaseForm.invalid">Tạo đơn nhập</button>
</form>
